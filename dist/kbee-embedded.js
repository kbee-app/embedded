!function(){var e={};try{!function(t,n){if("+"!==new t("q=%2B").get("q")||"+"!==new t({q:"+"}).get("q")||"+"!==new t([["q","+"]]).get("q")||"q=%0A"!==new t("q=\n").toString()||"q=+%26"!==new t({q:" &"}).toString()||"q=%25zx"!==new t({q:"%zx"}).toString())throw t;e.URLSearchParams=t}(URLSearchParams)}catch(URLSearchParams){!function(t,n,r){"use strict";var a=t.create,i=t.defineProperty,o=/[!'\(\)~]|%20|%00/g,c=/%(?![0-9a-fA-F]{2})/g,s=/\+/g,u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},h={append:function(e,t){d(this._ungap,e,t)},delete:function(e){delete this._ungap[e]},get:function(e){return this.has(e)?this._ungap[e][0]:null},getAll:function(e){return this.has(e)?this._ungap[e].slice(0):[]},has:function(e){return e in this._ungap},set:function(e,t){this._ungap[e]=[n(t)]},forEach:function(e,t){var r=this;for(var a in r._ungap)r._ungap[a].forEach(i,a);function i(i){e.call(t,i,n(a),r)}},toJSON:function(){return{}},toString:function(){var e=[];for(var t in this._ungap)for(var n=w(t),r=0,a=this._ungap[t];r<a.length;r++)e.push(n+"="+w(a[r]));return e.join("&")}};for(var f in h)i(l.prototype,f,{configurable:!0,writable:!0,value:h[f]});function l(e){var t=a(null);switch(i(this,"_ungap",{value:t}),!0){case!e:break;case"string"==typeof e:"?"===e.charAt(0)&&(e=e.slice(1));for(var n=e.split("&"),o=0,c=n.length;o<c;o++){var s=(u=n[o]).indexOf("=");-1<s?d(t,g(u.slice(0,s)),g(u.slice(s+1))):u.length&&d(t,g(u),"")}break;case r(e):for(o=0,c=e.length;o<c;o++){var u;d(t,(u=e[o])[0],u[1])}break;case"forEach"in e:e.forEach(p,t);break;default:for(var h in e)d(t,h,e[h])}}function p(e,t){d(this,t,e)}function d(e,t,n){var a=r(n)?n.join(","):n;t in e?e[t].push(a):e[t]=[a]}function g(e){return decodeURIComponent(e.replace(c,"%25").replace(s," "))}function w(e){return encodeURIComponent(e).replace(o,v)}function v(e){return u[e]}e.URLSearchParams=l}(Object,String,Array.isArray)}!function(e){var t=!1;try{t=!!Symbol.iterator}catch(r){}function n(e,n){var r=[];return e.forEach(n,r),t?r[Symbol.iterator]():{next:function(){var e=r.shift();return{done:void 0===e,value:e}}}}"forEach"in e||(e.forEach=function(e,t){var n=this,r=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach((function(a){!a.length||a in r||(r[a]=n.getAll(a)).forEach((function(r){e.call(t,r,a,n)}))}))}),"keys"in e||(e.keys=function(){return n(this,(function(e,t){this.push(t)}))}),"values"in e||(e.values=function(){return n(this,(function(e,t){this.push(e)}))}),"entries"in e||(e.entries=function(){return n(this,(function(e,t){this.push([t,e])}))}),!t||Symbol.iterator in e||(e[Symbol.iterator]=e.entries),"sort"in e||(e.sort=function(){for(var e,t,n,r=this.entries(),a=r.next(),i=a.done,o=[],c=Object.create(null);!i;)t=(n=a.value)[0],o.push(t),t in c||(c[t]=[]),c[t].push(n[1]),i=(a=r.next()).done;for(o.sort(),e=0;e<o.length;e++)this.delete(o[e]);for(e=0;e<o.length;e++)t=o[e],this.append(t,c[t].shift())}),function(t){var n=t.defineProperty,r=t.getOwnPropertyDescriptor,a=function(t){var n=t.append;t.append=e.append,URLSearchParams.call(t,t._usp.search.slice(1)),t.append=n},i=function(e,t){if(!(e instanceof t))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+t.name)},o=function(o){var c,s,u=o.prototype,h=r(u,"searchParams"),f=r(u,"href"),l=r(u,"search");!h&&l&&l.set&&(s=function(t){function r(n,r){e.append.call(this,n,r),n=this.toString(),t.set.call(this._usp,n?"?"+n:"")}function a(n){e.delete.call(this,n),n=this.toString(),t.set.call(this._usp,n?"?"+n:"")}function i(n,r){e.set.call(this,n,r),n=this.toString(),t.set.call(this._usp,n?"?"+n:"")}return function(e,t){return e.append=r,e.delete=a,e.set=i,n(e,"_usp",{configurable:!0,writable:!0,value:t})}}(l),c=function(e,t){return n(e,"_searchParams",{configurable:!0,writable:!0,value:s(t,e)}),t},t.defineProperties(u,{href:{get:function(){return f.get.call(this)},set:function(e){var t=this._searchParams;f.set.call(this,e),t&&a(t)}},search:{get:function(){return l.get.call(this)},set:function(e){var t=this._searchParams;l.set.call(this,e),t&&a(t)}},searchParams:{get:function(){return i(this,o),this._searchParams||c(this,new URLSearchParams(this.search.slice(1)))},set:function(e){i(this,o),c(this,e)}}}))};try{o(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&o(URL)}catch(c){}}(Object)}(e.URLSearchParams.prototype);var t,n=(t=e.URLSearchParams)&&t.__esModule?t:{default:t};window.Kbee={render:function(e){var t=e.target,r=e.token,a=e.apiKey,i=e.spaceUrl;document.addEventListener("DOMContentLoaded",(function(){var e=window.location.pathname,o=new n.default(window.location.search),c=o.get("kbee")?decodeURI(o.get("kbee")):null,s="string"==typeof t?document.querySelector(t):t;if("string"==typeof t&&!s)throw new Error('Target element with selector "'.concat(t,'" does not exist'));if(!(s instanceof Element||s instanceof HTMLDocument))throw new Error("Target element is not a valid DOM element");if(!i)throw new Error('"spaceUrl" is required');if(!r&&!a)throw new Error('One of "token" or "apiKey" is required');if(r)f(r);else{var u='{"url": "'.concat(i.split("://")[1],'","key":"').concat(a,'"}'),h=new XMLHttpRequest;h.addEventListener("readystatechange",(function(){4===this.readyState&&f(JSON.parse(this.responseText).jwt)})),h.open("POST","".concat(i,"/api/generateJWT")),h.send(u)}function f(t){s.innerHTML='<iframe src="'.concat(i).concat(c||"","?jwt=").concat(t,'" style="width:100%;height:100%;border:none"/>');var r=s.querySelector("iframe").contentWindow;window.addEventListener("popstate",(function(){var e=new n.default(window.location.search),r=e.get("kbee")?decodeURI(e.get("kbee")):null;s.querySelector("iframe").src="".concat(i).concat(r||"","?jwt=").concat(t)})),window.addEventListener("message",(function(t){if(t.source===r&&!(t.data.indexOf("jwt=")>-1)){var a=new n.default(window.location.search);a.set("kbee",t.data);var i="".concat(e,"?").concat(a.toString());window.history.pushState({},"",i)}}))}}))}}}();
//# sourceMappingURL=kbee-embedded.js.map